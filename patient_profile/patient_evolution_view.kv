#: import spinner_with_arrow auxiliary_classes.spinner_with_arrow

<PatientEvolutionView>:
    BoxLayout:
        orientation: 'vertical'
        canvas.before:
            Color:
                rgba: 0.95, 0.95, 0.95, 1
            Rectangle:
                pos: self.pos
                size: self.size
        
        # Container para Seleção de Data
        BoxLayout:
            orientation: 'vertical'
            size_hint_y: None
            height: self.minimum_height
            padding: dp(10)
            spacing: dp(5)

            Label:
                text: 'Selecione a Data:'
                color: 0,0,0,1
                size_hint_y: None
                height: self.texture_size[1]
                halign: 'left'

            BoxLayout:
                orientation: 'horizontal'
                spacing: dp(10)
                size_hint_y: None
                height: dp(48)

                TextInput:
                    id: day_input
                    hint_text: 'Dia'
                    input_filter: 'int'
                    multiline: False
                    on_text: root.enforce_text_limit(self, 2); root.on_date_selected()

                SpinnerWithArrow:
                    id: month_spinner
                    text: 'Mês'
                    values: ['Janeiro', 'Fevereiro', 'Março', 'Abril', 'Maio', 'Junho', 'Julho', 'Agosto', 'Setembro', 'Outubro', 'Novembro', 'Dezembro']
                    on_text: root.on_date_selected()

                SpinnerWithArrow:
                    id: year_spinner
                    text: 'Ano'
                    values: root.year_list
                    on_text: root.on_date_selected()

            Button:
                text: 'Preencher com a data de hoje'
                size_hint_y: None
                height: dp(40)
                font_size: '13sp'
                on_press: root.fill_today_date()

        # Área para os campos de métricas dinâmicas
        ScrollView:
            GridLayout:
                id: metrics_grid
                cols: 1
                padding: [dp(10), dp(30), dp(10), dp(10)]
                spacing: dp(10)
                size_hint_y: None
                height: self.minimum_height

        # Botão de Salvar
        BoxLayout:
            size_hint_y: None
            height: dp(60)
            padding: dp(10)
            Button:
                text: 'Salvar Dados do Dia'
                on_press: root.save_evolution_data()