#: import box_layout_with_action_bar auxiliary_classes.box_layout_with_action_bar
#: import spinner_with_arrow auxiliary_classes.spinner_with_arrow
#: import MedicationsView doctor_profile.medication_view
#: import EventsView doctor_profile.events_view
#: import DiagnosticsView doctor_profile.diagnostics_view
#: import DoctorSettingsView doctor_profile.doctor_settings_view
#: import PatientManagementView doctor_profile.patient_management_view
#: import PatientSettingsView doctor_profile.patient_settings_view
#: import PatientEvolutionView doctor_profile.patient_evolution_view

<DoctorHomeScreen>:
    BoxLayout:
        orientation: 'vertical'
        canvas.before:
            Color:
                rgba: 0.95, 0.95, 0.95, 1
            Rectangle:
                pos: self.pos
                size: self.size

        # [R011] Top options block
        ActionBar:
            ActionView:
                use_separator: True
                # Menu button on the left [R011]
                ActionButton:
                    icon: 'images/three_bars_icon.png'
                    on_press: app.manager.push('doctor_menu')
                # Title with date in the center [R011]
                ActionPrevious:
                    title: root.title
                    with_previous: False # This is a main screen, no back arrow needed
                    app_icon: "images/placebo_logo.png"
                    app_icon_height: "25dp"
                    app_icon_width: "25dp"

        # Main content area - now a ScreenManager to switch between views
        ScreenManager:
            id: content_manager
            # [R012] The medications tab is shown by default
            DoctorMedicationsContentScreen:
                name: 'doctor_medications'
            DoctorEventsContentScreen:
                name: 'doctor_events'
            DoctorDiagnosticsContentScreen:
                name: 'doctor_diagnostics'
            PatientManagementScreen:
                name: 'patient_management'
            DoctorPatientSettingsContentScreen:
                name: 'patient_settings'
            DoctorPatientEvolutionContentScreen:
                name: 'doctor_evolution'


        # [R010] Bottom patient selection block
        BoxLayout:
            size_hint_y: None
            height: dp(60)
            padding: dp(10)
            spacing: dp(10)
            canvas.before:
                Color:
                    rgba: 0.85, 0.85, 0.85, 1 # Slightly darker background for the footer
                Rectangle:
                    pos: self.pos
                    size: self.size
            SpinnerWithArrow:
                id: patient_spinner
                text: 'Selecione um Paciente'
                values: root.patient_list
                size_hint_x: 1
                on_text: root.on_patient_selected(self.text)

<DoctorMenuScreen>:
    BoxLayoutWithActionBar:
        title: 'Menu' # 'Menu' is acceptable in Portuguese
        ScrollView:
            GridLayout:
                cols: 1
                padding: dp(20)
                spacing: dp(15)
                size_hint_y: None
                height: self.minimum_height

                Button:
                    text: 'Configurações do Aplicativo'
                    size_hint_y: None
                    height: dp(48)
                    on_press: root.go_to_screen('doctor_settings')
                Button:
                    text: 'Gerenciar Pacientes'
                    size_hint_y: None
                    height: dp(48)
                    on_press: root.go_to_screen('patient_management')
                Button:
                    text: 'Configurações do Paciente'
                    size_hint_y: None
                    height: dp(48)
                    on_press: root.go_to_screen('patient_settings')
                Button:
                    text: 'Medicações'
                    size_hint_y: None
                    height: dp(48) 
                    on_press: root.go_to_screen('doctor_medications')
                Button:
                    text: 'Exames/Consultas'
                    size_hint_y: None
                    height: dp(48)
                    on_press: root.go_to_screen('doctor_events')
                Button:
                    text: 'Diagnósticos'
                    size_hint_y: None
                    height: dp(48)
                    on_press: root.go_to_screen('doctor_diagnostics')
                Button:
                    text: 'Evolução do Paciente'
                    size_hint_y: None
                    height: dp(48)
                    on_press: root.go_to_screen('doctor_evolution')

<DoctorMedicationsContentScreen>:
    MedicationsView:

<DoctorEventsContentScreen>:
    EventsView:

<DoctorDiagnosticsContentScreen>:
    DiagnosticsView:

<DoctorSettingsScreen>:
    DoctorSettingsView:

<PatientManagementScreen@Screen>:
    on_enter: patient_management_view.on_enter()
    PatientManagementView:
        id: patient_management_view

<DoctorPatientSettingsContentScreen>:
    PatientSettingsView:

<DoctorPatientEvolutionContentScreen>:
    on_enter: evolution_view.on_enter()
    PatientEvolutionView:
        id: evolution_view